{#
# GNU MediaGoblin -- federated, autonomous media hosting
# Copyright (C) 2011, 2012 MediaGoblin contributors.  See AUTHORS.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#}
{% extends "mediagoblin/base.html" %}

{% import "/mediagoblin/utils/wtforms.html" as wtforms_util %}

{% block title -%}
    {% trans %}Editing{% endtrans %} {{ album.title }} &mdash; {{ super() }}
{%- endblock %}

{% block mediagoblin_head %}
  {% include "dogma/parts/calendar_head.html"  %}
  {% include "dogma/parts/geo_head.html"  %}
  <script type="text/javascript" src="{{request.staticdirect('/dogma/js/add_methods.js')}}"></script>
  <script type="text/javascript" src="{{request.staticdirect('/dogma/js/edit_methods.js')}}"></script>
{% endblock %}
{% block mediagoblin_content %}
  <form action="{{ request.urlgen('mediagoblin.plugins.dogma.edit_album', band_id = band.id, album_id= album.id)}}"
        method="POST" enctype="multipart/form-data">
    <div class="form_box_xl edit_box">
      <h1>{% trans %}Editing{% endtrans %} {{ album.title }}</h1>
      <div style="text-align: center;" >
        <img src="/mediagoblin/plugins/dogma/uploaded_images/band_photos/thumbs/{{album.id}}_th.jpeg" />
      </div>
      {{ wtforms_util.render_divs(form) }}
      {% set count = 0 %}
      {% for member in band.members %}
         <div class="form_field_input album_member" data-since="{{member.millis_since}}" {% if member.millis_until %}data-until="{{member.millis_until}}" {% endif %}>
            <p class="form_field_label">
              <label for="roles_{{count}}">{{member.member_global.username}} {% trans %}plays{% endtrans %}* : <label>
            </p>
            <input name="roles_{{count}}" type="text">
            <input name="member_{{count}}" value="{{member.id}}" type="hidden">
            <p class="form_field_description">
              {% trans  %}Use commas to separate instuments (e.g. : guitars, backing vocals, samples){% endtrans %}
            </p>
         </div>
         {% set count = count + 1 %}
      {% endfor %}
      <div class="form_submit_buttons">
        <a class="button_action" href="{{ request.urlgen('mediagoblin.plugins.dogma.dashboard')}}">{% trans %}Cancel{% endtrans %}</a>
        <input type="submit" value="{% trans %}Save changes{% endtrans %}" class="button_form" />
	{{ csrf_token }}
      </div>
    </div>
  </form>

{% endblock %}
